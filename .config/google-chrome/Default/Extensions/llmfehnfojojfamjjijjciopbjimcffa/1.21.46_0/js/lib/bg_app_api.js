var AppApi=function(){};AppApi.prototype={init:function(a){this.db=DBManager(TableNames.USER_COOKIES);this.db.async=AsyncDBManager(TableNames.DB_ASYNC);this.internal={};this.internal.db=DBManager(TableNames.INTERNAL_DB);this.internal.db.async=AsyncDBManager(TableNames.INTERNAL_DB_ASYNC);this.db._self=this;this.internal.db._self=this;this.__should_activate_validation__=true;this.appID=Crossrider.appID;this.cr_version=Crossrider.manifest.version;this.version=Crossrider.manifest.ver;this.platform=Crossrider.manifest.platform;this._cookies=a;this.manifest=Crossrider.manifest;this.db.init(this);this.db.async.init(this);this.internal.db.init(this);this.internal.db.async.init(this);this.cookie=new Cookie(this);this.chrome=new ChromeAPI(this);this.browserAction=this.chrome.browserAction;this.tabs=this.chrome.tabs;this.message=new Message(this);this.contextMenu=this.chrome.contextMenu;this.dom=this.chrome.dom;this.isBackground=true;},openURL:function(b,a){Crossrider.openURL(b,a);},superAlert:function(a){Crossrider.superAlert(a);},removeExpiredCookies:function(b,d){if(d.length>0){for(var c=0;c<d.length;++c){var a=d[c];if((d.indexOf(a)>=0)&&this._cookies[b].hasOwnProperty(a)){delete this._cookies[b][a];}}}},updateCookie:function(b,c,a){var d=c.expires instanceof (Date)?c.expires:new Date(c.expires);this._cookies[a][b]={value:c.value,expires:d};},updateCookieExpiration:function(c,a,b){this._cookies[b][c].expires=a;},unsetCookie:function(b,a){if(this._cookies[a][b]){delete this._cookies[a][b];}},removeAllCookies:function(a,b,c){if(b){for(cookie in this._cookies[a]){if(c.indexOf(cookie)<0){delete this._cookies[a][cookie];}}}else{this._cookies[a]={};}},updateRealCookie:function(a,b){var c=b.expires instanceof (Date)?b.expires:new Date(b.expires);this._cookies[TableNames.USER_COOKIES].mysite[a]={value:b.value,expires:c};},unsetRealCookie:function(a){if(this._cookies[TableNames.USER_COOKIES].mysite[a]){delete this._cookies[TableNames.USER_COOKIES].mysite[a];}},callPageFunction:function(a){document.location.apply("javascript:"+a+"()");},isDebugMode:function(){return Crossrider.debug;},getCrossriderID:function(){return Crossrider._bic;},background:{reload:function(){Crossrider.reload();}},onBeforeNavigate:function(c,a){function b(f){var d=f;if(IsDefined(UserReport)&&IsDefined(f)){var e=f.hasOwnProperty("name")&&IsDefined(f.name)?f.name:"appAPI.onBeforeNavigate UserCallback";d=UserReport.surroundCallbackWithTryCatch(f,e);}return d;}if(typeof Crossrider!=="undefined"){if(c&&typeof(c)==="function"){Crossrider._registerOldOnceOnBeforeNavigate();c=b(c);Crossrider.events.oldBeforeNavigate.addEventListener(c,a);}}},onRequest:function(c,a){function b(f){var d=f;if(IsDefined(UserReport)&&IsDefined(f)){var e=f.hasOwnProperty("name")&&IsDefined(f.name)?f.name:"appAPI.onRequest UserCallback";d=UserReport.surroundCallbackWithTryCatch(f,e);}return d;}if(typeof Crossrider!=="undefined"){if(c&&typeof(c)==="function"){Crossrider._registerOldWebRequestOnce();c=b(c);Crossrider.events.oldWebRequest.addEventListener(c,a);}}},webRequest:{onRequest:{addListener:function(c,a){function b(f){var d=f;if(IsDefined(UserReport)&&IsDefined(f)){var e=f.hasOwnProperty("name")&&IsDefined(f.name)?f.name:"appAPI.onRequest UserCallback";d=UserReport.surroundCallbackWithTryCatch(f,e);}return d;}if(typeof Crossrider!=="undefined"){if(c&&typeof(c)==="function"){Crossrider._registerWebRequestOnce();c=b(c);return Crossrider.events.webRequest.addEventListener(c,a);}}return null;},removeListener:function(a){if(a){return Crossrider.events.webRequest.remove(a);}else{return Crossrider.events.webRequest.removeAll();}},updateOpaque:function(b,a){return Crossrider.events.webRequest.updateOpaque(b,a);}},onBeforeNavigate:{addListener:function(c,a){function b(f){var d=f;if(IsDefined(UserReport)&&IsDefined(f)){var e=f.hasOwnProperty("name")&&IsDefined(f.name)?f.name:"appAPI.onBeforeNavigate UserCallback";d=UserReport.surroundCallbackWithTryCatch(f,e);}return d;}if(typeof Crossrider!=="undefined"){if(c&&typeof(c)==="function"){Crossrider._registerOnceOnBeforeNavigate();c=b(c);return Crossrider.events.beforeNavigate.addEventListener(c,a);}}return null;},removeListener:function(a){if(a){return Crossrider.events.beforeNavigate.remove(a);}else{return Crossrider.events.beforeNavigate.removeAll();}},updateOpaque:function(b,a){return Crossrider.events.beforeNavigate.updateOpaque(b,a);}}}};
