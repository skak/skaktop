var XHR=function(d){var u=[200,201,202,203,204,205,206,207,226];var n=d;var j=d.callback;var l=(d.method||"get").toUpperCase();var m=d.data||null;var r=d.type||"text";var s=d.async;var k=new XMLHttpRequest();k.open(l,d.url,d.async);var a=false;var o=(typeof d.contentType==="string")?d.contentType:"application/x-www-form-urlencoded";var c=d.additionalRequestHeaders;i();if(l==="POST"){k.setRequestHeader("Content-type",o);m=h(m);}function i(){if(typeof c==="object"){for(var v in c){if(c.hasOwnProperty(v)){k.setRequestHeader(v,c[v]);}}}}function h(x){if(typeof x==="string"){return x;}if(typeof x!=="object"){return null;}var w="";for(var v in x){if(x.hasOwnProperty(v)){if(w!==""){w+="&";}if(typeof x[v]!=="string"&&typeof x[v]!=="number"){return null;}w+=escape(v)+"="+escape(x[v]);}}return w;}function p(y){var B;try{if(typeof y==="string"){var v=0,x=1;y=y.replace(/\r\n/g,"\n");if(y.lastIndexOf("\n")+1==y.length){y=y.trim();}var w=y.split("\n");B={};w.forEach(function(D){var C=D.split(": ");B[C[v]]=C[x];});}}catch(A){var z="_toHeadersObject, IsDefined:"+typeof IsDefined+",Remove:"+typeof[].remove;if(typeof Reports!=="undefined"){Reports.error(ErrorMessage(A,z));}}return B;}function g(){var v={};try{var w=(typeof k.getAllResponseHeaders==="function")?k.getAllResponseHeaders():undefined;v=p(w);}catch(x){q(x,"_headersToObject,IsDefined:"+typeof IsDefined+",ResponseHeaders:"+typeof ResponseHeaders);}return v;}function b(w){var v="XHR EXCEPTION: "+w.message+", CODE: "+w.code+"\nURL: "+n.url+", METHOD: "+l+", IS ASYNC: "+n.async;if(typeof(Crossrider)!=="undefined"){Crossrider.Utils.internalDebug(v);}t(w);}function f(){try{if(k.readyState===4){if(u.indexOf(k.status)>=0||(!s&&k.status===0)){var v=k[r==="xml"?"responseXML":"responseText"];if(s&&typeof j==="function"){var w=g();j({call:"success",response:v,additionalInfo:{headers:w}});}else{return v;}}else{if(s&&typeof j==="function"){t(k.status);}else{return null;}}}}catch(x){q(x,"_onReadyStateChange");}}function t(w){try{if(s&&typeof j==="function"&&!a){a=true;j({call:"failure",response:w});}}catch(v){q(v,"_callFailureCallback");}}function q(w,v){if(typeof Reports!=="undefined"){Reports.error(ErrorMessage(w,v));}}var e=function(){try{if(s){try{k.onreadystatechange=f;k.send(m);}catch(v){b(v);}}else{try{k.send(m);}catch(v){b(v);return null;}return f();}}catch(v){q(v,"send");}};return{send:e};};
