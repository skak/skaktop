var Message=function(a){var g=null,e={};var d=(a.manifest.runiniframe=="true");var b=0;function h(k){var i=k;if(IsDefined(UserReport)&&IsDefined(k)){var j=(k.hasOwnProperty("name")&&IsDefined(k.name))?k.name:"Message UserCallback";i=UserReport.surroundCallbackWithTryCatch(k,j);}return i;}function c(j,k,i){var k=(typeof(k)==="undefined")?false:k;var i=(typeof(i)==="undefined")?true:i;return{message:j,to_iframe:(d&&k),to_top_window:i};}var f=function(j,k,i){if(typeof(Crossrider)==="undefined"){InternalMessaging.messageToBackground({action:"message",params:[j,k,g]});}else{Crossrider.message(j,k);}};this.setTabId=function(i){g=i;};this.toActiveTab=function(j,i){i=typeof(i)==="undefined"?true:i;f("active",c(j,i),g);};this.toAllTabs=function(j,i){i=typeof(i)==="undefined"?true:i;f("all",c(j,i),g);};this.toAllOtherTabs=function(j,i){i=typeof(i)==="undefined"?true:i;f("allOtherTabs",c(j,i),g);};this.toBackground=function(i){f("background",c(i),g);};this.toCurrentTabWindow=function(i){f("to_tab",c(i),g);};this.toCurrentTabIframes=function(k){var j=true;var i=true;f("to_tab",c(k,j,!i),g);};this.toPopup=function(i){f("popup",c(i),g);};this.call=function(k){var i=(window.top!==window.self);if((!i&&!k.to_top_window)||(i&&(!k.to_iframe||!d))){return;}for(var j in e){if(e.hasOwnProperty(j)){if(e[j].isPopup===true&&k.isToPopup===true){if(chrome.extension.getViews({type:"popup"}).length>0){e[j].callback(k.message);}}else{if(e[j].isPopup!==true&&k.isToPopup!==true){e[j].callback(k.message);}}}}};this.addListener=function(i){if(typeof i!="undefined"&&typeof i=="function"){i=h(i);++b;e[b]={callback:i};return b;}};this.removeListener=function(i){if(typeof(i)==="undefined"){e={};return true;}if(e.hasOwnProperty(i)){delete e[i];return true;}return false;};this._addListenerToPopup=function(i){if(typeof i!="undefined"&&typeof i=="function"){i=h(i);++b;e[b]={callback:i,isPopup:true};return b;}};this._removePopupListeners=function(){for(var i in e){if(e.hasOwnProperty(i)){if(e[i].isPopup===true){delete e[i];}}}};return this;};var InternalMessaging=function(){function b(){return typeof(Crossrider)!=="undefined";}function e(f){var g=new Error(IsDefined(f)?f:"message undefined");Reports.error(new ErrorMessage(g,"InternalMessaging->sendMesage"));}function d(g){var f=true;if(!IsDefined(g)||!g.hasOwnProperty("action")){e(IsDefined(g)?"message missing action":undefined);f=false;}else{if(!(typeof g.action==="string")||!(g.action.length>0)){e("action string error");f=false;}}return f;}function c(f,g,h){if(d(g)){if(typeof h==="function"){chrome.tabs.sendRequest(f,g,h);}else{chrome.tabs.sendRequest(f,g);}}}function a(f,g){if(d(f)){if(typeof g==="function"){chrome.extension.sendRequest(f,g);}else{chrome.extension.sendRequest(f);}}}return{messageToPage:function(f,g,h){if(typeof chrome.tabs.sendMessage==="undefined"){c(f,g,h);}else{if(d(g)){if(typeof h==="function"){chrome.tabs.sendMessage(f,g,h);}else{chrome.tabs.sendMessage(f,g);}}}},messageToBackground:function(f,g){if(typeof chrome.extension.sendMessage==="undefined"){a(f,g);}else{if(d(f)){if(typeof g==="function"){chrome.extension.sendMessage(f,g);}else{chrome.extension.sendMessage(f);}}}},responseLater:true};}();
