var ChromeAPI=function(e){var a=e,b=typeof(Crossrider)!=="undefined",c={};this.notification={show:function(k,j,i,h){var g=d();c[g]=h||{};if(b){Crossrider.notification(k,j,i,g,a.tabID);}return g;},showHTML:function(g,i){var h=d();c[h]=i||{};if(b){Crossrider.htmlNotification(g,h,a.tabID);}return h;},hide:function(g){if(b){Crossrider.hideNotification(g);}}};function d(){var m=new Date();var l=m.getTime().toString(16);var k=[],g="0123456789abcdef";for(var h=0;h<(32-l.length);h++){k[h]=g.substr(Math.floor(Math.random()*16),1);}var j=l+k.join("");return j;}a.handleNotificationEvent=function(h,g){var i=c[g];if(i){f=i[h];if(typeof(f)==="function"){f();}if(h==="onclose"){delete c[g];}}};this.omnibox=Omnibox;this.contextMenu=new ContextMenu();this.browserAction=new BrowserAction();this.tabs=new Tabs();this.dom=new Dom();return this;};var Omnibox={setDefaultSuggestion:function(b){try{chrome.omnibox.setDefaultSuggestion(b);}catch(a){Reports.error(new ErrorMessage(a,"Omnibox->setDefaultSuggestion"));crLogger.error("Omnibox->setDefaultSuggestion");}},onInputCancelled:function(b){try{chrome.omnibox.onInputCancelled.addListener(b);}catch(a){Reports.error(new ErrorMessage(a,"Omnibox->onInputCancelled"));crLogger.error("Omnibox->onInputCancelled");}},onInputChanged:function(b){try{chrome.omnibox.onInputChanged.addListener(b);}catch(a){Reports.error(new ErrorMessage(a,"Omnibox->onInputChanged"));crLogger.error("Omnibox->onInputChanged");}},onInputEntered:function(b){try{chrome.omnibox.onInputEntered.addListener(b);}catch(a){Reports.error(new ErrorMessage(a,"Omnibox->onInputEntered"));crLogger.error("Omnibox->onInputEntered");}},onInputStarted:function(b){try{chrome.omnibox.onInputStarted.addListener(b);}catch(a){Reports.error(new ErrorMessage(a,"Omnibox->onInputStarted"));crLogger.error("Omnibox->onInputStarted");}}};var ContextMenu=function(){var c=["all","page","textSelection","link","image"];var g=["http://*/*","https://*/*"];var j={};function k(n){var l=n;if(IsDefined(UserReport)&&IsDefined(n)){var m=(n.hasOwnProperty("name")&&IsDefined(n.name))?n.name:"ContextMenu UserCallback";l=UserReport.surroundCallbackWithTryCatch(n,m);}return l;}function h(m){var l=k(m);return function(p,o){var n={pageUrl:p.pageUrl};if(p.hasOwnProperty("linkUrl")){n.linkUrl=p.linkUrl;}if(p.hasOwnProperty("selectionText")){n.selectedText=p.selectionText;}if(p.hasOwnProperty("mediaType")&&(p.mediaType==="image")&&p.hasOwnProperty("srcUrl")){n.srcUrl=p.srcUrl;}l(n);};}function i(m){var l=true;try{if(!m||m.length<=0){l=false;}for(var n=0;n<m.length&&l;++n){currentContext=m[n];if(c.indexOf(currentContext)==-1){l=false;}}}catch(o){Reports.error(new ErrorMessage(o,"ContextMenu->_isValidContextArray"));crLogger.error("ContextMenu->_isValidContextArray");}return l;}function a(m,l){return{id:m,isSeprator:l};}function b(l){return(l&&(typeof(l)==="string")&&j.hasOwnProperty(l));}function e(l){return(b(l)?j[l].id:null);}function d(n){var l=[];try{for(var m=0;m<n.length;++m){if(n[m]=="textSelection"){l.push("selection");}else{l.push(n[m]);}}}catch(o){Reports.error(new ErrorMessage(o,"ContextMenu->_changeContextToChromeSpecific"));crLogger.error("ContextMenu->_changeContextToChromeSpecific");}return l;}return{add:function(m,q,p,n){try{n=n||["page"];if(IsDefined(m)&&IsDefined(q)&&!b(m)&&(typeof(q)==="string")&&(typeof(p)==="function")&&i(n)){n=d(n);var r=chrome.contextMenus.create({title:q,contexts:n,onclick:h(p),documentUrlPatterns:g});if(r){var l=false;j[m]=new a(r,l);return true;}}}catch(o){Reports.error(new ErrorMessage(o,"ContextMenu->add"));crLogger.error("ContextMenu->add");}return false;},addSeparator:function(m){try{if(IsDefined(m)&&!b(m)){var o=chrome.contextMenus.create({type:"separator",documentUrlPatterns:g,contexts:["all"]});if(o){var l=true;j[m]=new a(o,l);return true;}}}catch(n){Reports.error(new ErrorMessage(n,"ContextMenu->addSeparator"));crLogger.error("ContextMenu->addSeparator");}return false;},remove:function(l){try{if(IsDefined(l)&&b(l)){chrome.contextMenus.remove(e(l));delete j[l];return true;}}catch(m){Reports.error(new ErrorMessage(m,"ContextMenu->remove"));crLogger.error("ContextMenu->remove");}return false;},removeAll:function(){try{chrome.contextMenus.removeAll();j={};}catch(l){Reports.error(new ErrorMessage(l,"ContextMenu->removeAll"));crLogger.error("ContextMenu->removeAll");}return true;},updateTitle:function(l,n){try{if(b(l)&&!(j[l].isSeprator)&&typeof(n)==="string"){chrome.contextMenus.update(e(l),{title:n});return true;}}catch(m){Reports.error(new ErrorMessage(m,"ContextMenu->updateTitle"));crLogger.error("ContextMenu->updateTitle");}return false;},updateOnClick:function(l,n){try{if(b(l)&&!(j[l].isSeprator)&&(typeof(n)==="function")){chrome.contextMenus.update(e(l),{onclick:h(n)});return true;}}catch(m){Reports.error(new ErrorMessage(m,"ContextMenu->updateOnClick"));crLogger.error("ContextMenu->updateOnClick");}return false;}};};var BrowserAction=function(){var a=undefined;function b(j){var g=19;var d=19;var i=document.createElement("canvas");var e=i.getContext("2d");var h=new Image();h.src=j;h.onload=function(){i.width=g;i.height=d;if(h.width>d||h.height>d){e.scale(g/h.width,d/h.height);}e.drawImage(h,0,0);var k=e.getImageData(0,0,i.width,i.height);chrome.browserAction.setIcon({imageData:k});};}function c(g){var d=g;if(IsDefined(UserReport)&&IsDefined(g)){var e=(g.hasOwnProperty("name")&&IsDefined(g.name))?g.name:"BrowserAction UserCallback";d=UserReport.surroundCallbackWithTryCatch(g,e);}return d;}return{setBadgeText:function(h,d){try{chrome.browserAction.setBadgeText({text:h});if(IsDefined(d)){this.setBadgeBackgroundColor(d);}}catch(g){UserReport.error(new ErrorMessage(g,"setBadgeText"));crLogger.error("setBadgeText");}},setBadgeBackgroundColor:function(d){try{chrome.browserAction.setBadgeBackgroundColor({color:d});}catch(g){UserReport.error(new ErrorMessage(g,"setBadgeBackgroundColor"));crLogger.error("setBadgeBackgroundColor");}},setIcon:function(h){try{var d=(typeof(h)==="number")&&(isNaN(h)||(h<1||h>5));var g=(typeof(h)==="string")&&(h.length==0);if((typeof(h)==="undefined")||d||g){h=1;}if(typeof(h)==="number"){var i=chrome.extension.getURL("icons/actions/"+h+".png");chrome.browserAction.setIcon({path:i});}else{if(typeof(h)==="string"){b(h);}}}catch(j){UserReport.error(new ErrorMessage(j,"setIcon"));crLogger.error("setIcon");}},setTitle:function(g){try{chrome.browserAction.setTitle({title:g});}catch(d){UserReport.error(new ErrorMessage(d,"setTitle"));crLogger.error("setTitle");}},enablePopup:function(){try{chrome.browserAction.setPopup({popup:"popup.html"});}catch(d){UserReport.error(new ErrorMessage(d,"enablePopup"));crLogger.error("enablePopup");}},disablePopup:function(){try{chrome.browserAction.setPopup({popup:""});}catch(d){UserReport.error(new ErrorMessage(d,"disablePopup"));crLogger.error("disablePopup");}},removeBadge:function(){try{this.setBadgeText("");}catch(d){UserReport.error(new ErrorMessage(d,"removeBadge"));crLogger.error("removeBadge");}},onClick:function(d){chrome.browserAction.setPopup({popup:""});if(IsDefined(d)&&typeof d==="function"){if(a===undefined){chrome.browserAction.onClicked.addListener(function(){if(typeof(a)==="function"){a();}}.bind(this));}a=c(d);}},setPopupHTML:function(d){var e=DataStore.Plugins.getPluginsCodeByType(PluginTypes.POPUP,Crossrider._plugins,Crossrider.debug);d+='\n\n<script type="text/javascript"> \n\n'+e+'\n\nif (typeof crossriderMain === "function") {	crossriderMain(jQuery);}<\/script>';chrome.browserAction.setPopup({popup:"popup.html"});chrome.extension.onMessage.addListener(function(j,i,g){if(j=="popup_ready"){appAPI.message._removePopupListeners();var h=chrome.extension.getViews({type:"popup"});if(h.length>0){var k=h[0].document;h[0].appAPI=new AppApi();h[0].appAPI.init(Crossrider._cookies);h[0].appAPI.message.addListener=h[0].appAPI.message._addListenerToPopup;k=k.open("text/html","replace");k.write(d);k.close();}}});},clearPopup:function(){chrome.browserAction.setPopup({popup:""});}};};var TabInfo=function(a){if(typeof a=="undefined"){return null;}else{this.tabID=a.hasOwnProperty("id")?a.id:undefined;this.tabURL=a.hasOwnProperty("url")?a.url:undefined;return this;}};var Tabs=function(b){function c(j,i){if(typeof Reports!=="undefined"){Reports.error(new ErrorMessage(j,i));crLogger.error("setBadgeText");}}function g(l,j){var i=l;if(IsDefined(UserReport)&&IsDefined(l)){var k=j||"appAPI.tabs UserCallback";if(l.hasOwnProperty("name")&&IsDefined(l.name)){k=l.name;}i=UserReport.surroundCallbackWithTryCatch(l,k);}return i;}function a(i){i=g(i,"onTabSelectionChanged");return function(j){function k(p){var o={};if(typeof p!=="undefined"&&p.hasOwnProperty("id")){var n=p.id;o.tabId=n;if(p.hasOwnProperty("url")){var m=p.url;o.tabUrl=m;}i(o);}}try{if(j&&j.hasOwnProperty("tabId")){chrome.tabs.get(j.tabId,k);}}catch(l){c(l,"Tabs->_tabSelectionChangedGetTabCallbackFunction");crLogger.error("Tabs->_tabSelectionChangedGetTabCallbackFunction");}};}function e(i){i=g(i,"onTabCreated");return function(m){try{var l={};if(m&&m.hasOwnProperty("id")){var k=m.id;l.tabId=k;if(m.hasOwnProperty("url")){var j=m.url;l.tabUrl=j;}i(l);}}catch(n){c(n,"Tabs->_tabCreatedHandler");crLogger.error("Tabs->_tabCreatedHandler");}};}function h(i){i=g(i,"onTabClosed");return function(k,j){try{if(k!=undefined){i({tabId:k});}}catch(l){c(l,"Tabs->_tabClosedHandler");crLogger.error("Tabs->_tabClosedHandler");}};}function d(i,j){if(typeof Crossrider!=="undefined"&&typeof Crossrider.events!=="undefined"&&typeof Crossrider.events[i]!=="undefined"){if(typeof j==="function"){return Crossrider.events[i].addEventListener(j);}}}return{onTabSelectionChanged:function(i){return d("tabSelectionChanged",a(i));},onTabCreated:function(i){return d("tabCeated",e(i));},onTabClosed:function(i){return d("tabClosed",h(i));},create:function(i){if(i&&typeof i==="string"){Crossrider.openURL(i,"tab");}},getAllTabs:function(j){var i="http";if(typeof j=="function"){j=g(j);chrome.windows.getAll({populate:true},function(o){var k=[];for(var n=0;n<o.length;++n){for(var m=0;m<o[n].tabs.length;++m){var p=o[n].tabs[m];if(typeof p!=="undefined"&&p.hasOwnProperty("url")&&p.url.indexOf(i)==0){var l={tabId:p.id,tabUrl:p.url};k.push(l);}}}j(k);});}}};};var Dom=function(){return{onDocumentStart:function(){function b(h,g){if(IsDefined(UserReport)){UserReport.error(new ErrorMessage(h,g));}}function a(g,e){var h=typeof g==="string"?new RegExp("^http.?\\:\\/\\/(?:www\\.)?"+g.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"),"i"):g;return h.test(e);}function d(j,g){var h=false;if(!IsDefined(j)){h=true;}else{if(typeof j==="string"||j instanceof RegExp){j=[j];}if(Array.isArray(j)){for(var e=0;(e<j.length)&&!h;++e){if(typeof j[e]==="string"||j[e] instanceof RegExp){h=a(j[e],g);}}}}return h;}function c(g,e,h){return function(i){if(i.frameId==0&&IsDefined(i.url)&&i.url.indexOf("http")>=0){if(IsDefined(g)&&typeof g==="string"){if(chrome.tabs.hasOwnProperty(g)){if(d(h,i.url)){try{chrome.tabs[g](i.tabId,{code:e,runAt:"document_start"});}catch(j){b(j,"appAPI.dom.onDocumentStart");crLogger.error("appAPI.dom.onDocumentStart");}}}}}}.bind(this);}return{addCSS:function(e,g){if(IsDefined(e)&&typeof e==="string"){chrome.webNavigation.onDOMContentLoaded.addListener(c("insertCSS",e,g));}else{b(new Error("CSSCode is incompatible"),"appAPI.dom.onDocumentStart.addCSS");crLogger.error("appAPI.dom.onDocumentStart.addCSS");}},addJS:function(e,g){if(IsDefined(e)&&typeof e==="string"){chrome.webNavigation.onDOMContentLoaded.addListener(c("executeScript",e,g));}else{b(new Error("JSCode is incompatible"),"appAPI.dom.onDocumentStart.addJS");crLogger.error("appAPI.dom.onDocumentStart.addJS");}}};}()};};
