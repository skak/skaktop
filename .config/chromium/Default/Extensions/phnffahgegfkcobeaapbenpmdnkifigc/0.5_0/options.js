var NO_SWITCH_WARNING="You don't have any header switches created. Click on 'Custom Request Headers' and add a new header switch first.";function warnOnDisallowedHeader(){if(isDisallowedHeader($("#add_header").val())){return setStatus("Warning: Chrome does not allow the "+$("#add_header").val()+" header to be modified for security reasons.","#add_header")}else{return setStatus("")}}function setStatus(a,b){if(a!=""&&b){_showFloatingDiv("#status",a,b);return true}else{_hideFloatingDiv("#status");return false}}function _showFloatingDiv(b,a,d){$(b).text(a);$(b).removeClass("invisible");$(b).addClass("visible");var c=$(d).offset();c.top=c.top+$(d).outerHeight();$(b).offset(c)}function _hideFloatingDiv(a){$(a).removeClass("visible");$(a).addClass("invisible")}function isDisallowedHeader(a){return(a&&prohibitedHeaders.indexOf(a)>-1)}function addHeaderSwitch(){if(!warnOnDisallowedHeader()){if($("#add_header").val()==""){setStatus("A header is required.","#add_header")}else{setStatus();addHeaderSwitchOption($("#add_title").val(),$("#add_header").val(),$("#add_string").val(),($("#add_is_append").val()=="true"),$("#add_regex").val());restoreOptions()}}}function _atoi(b){}function addPresetHeaderSwitch(){var b=getSwitchList();var a=b[parseInt($("#header_switch_options").attr("value",$("#options option:selected").val()))];if($("#add_domain").val()==""||!a){setStatus("Both domain and a header switch are required.","#add_domain")}else{setStatus("");addPresetSwitch($("#add_domain").val(),a)}restoreOptions()}function getHeaderSwitchDropdown(){var a=document.createElement("select");a.setAttribute("id","header_switch_options");var d=getSwitchList();for(var b=0;b<d.length;b++){var c=document.createElement("option");c.setAttribute("value",""+b);c.appendChild(document.createTextNode(d[b].getPopupDisplayString()));a.appendChild(c)}return a}function _newRow(a){var c=document.createElement("tr");for(var b=0;b<a.length;b++){var d=document.createElement("td");d.appendChild(a[b]);c.appendChild(d)}return c}function addPresetSwitchTitleRow(){var a=_newRow([document.createTextNode("Domain"),document.createTextNode("Header Switch"),document.createTextNode("")]);a.setAttribute("class","title");return a}function addHeaderSwitchTitleRow(){var a=_newRow([document.createTextNode("Title"),document.createTextNode("Header"),document.createTextNode("Append/Replace"),document.createTextNode("String"),document.createTextNode("Match String"),document.createTextNode("")]);a.setAttribute("class","title");return a}function addHeaderSwitchRow(c,b){var a=document.createElement("input");a.type="button";a.setAttribute("id","delete_header_"+b);a.value="Delete";return _newRow([document.createTextNode(c.title),document.createTextNode(c.header),(c.append?document.createTextNode("Append"):document.createTextNode("Replace With")),document.createTextNode(c.string),document.createTextNode(c.regex),a])}function addNewPresetEntryRow(){var c=document.createElement("input");var a=document.createElement("input");a.setAttribute("id","add_domain");var b=document.createElement("input");b.type="button";b.setAttribute("id","add_preset");b.setAttribute("id","add_preset_button");b.value="Add";return _newRow([a,getHeaderSwitchDropdown(),b])}function addPresetHeaderSwitchRow(c,b){var a=document.createElement("input");a.type="button";a.setAttribute("id","delete_switch_"+b);a.value="Delete";return _newRow([document.createTextNode(c.domain),document.createTextNode(c.header_switch.getPopupDisplayString()),a])}function addNewHeaderSwitchEntryRow(){var f=document.createElement("input");var g=document.createElement("input");var b=document.createElement("input");var h=document.createElement("select");var d=document.createElement("input");f.setAttribute("id","add_title");b.setAttribute("id","add_string");g.setAttribute("id","add_header");h.setAttribute("id","add_is_append");d.setAttribute("id","add_regex");var a=document.createElement("option");a.setAttribute("value",false);a.appendChild(document.createTextNode("Replace With"));h.appendChild(a);var c=document.createElement("option");c.setAttribute("value",true);c.appendChild(document.createTextNode("Append"));h.appendChild(c);var e=document.createElement("input");e.type="button";e.setAttribute("id","add_button");e.value="Add";return _newRow([f,g,h,b,d,e])}function addNoSwitchWarningRow(){var b=document.createElement("td");b.appendChild(document.createTextNode(NO_SWITCH_WARNING));var a=document.createElement("tr");a.appendChild(b);return a}function deleteHeaderSwitch(a){deleteHeaderSwitchOption(a);setStatus("Switch entry deleted.");restoreOptions()}function deletePresetHeaderSwitch(a){deleteHeaderSwitchOption(a);setStatus("Preset entry deleted.");restoreOptions()}function refreshPresetSwitchView(){var b=$("#preset_switch_table #list_table");if(b){b.replaceWith(document.createElement("table"))}b=$("#preset_switch_table #tablecontainer table");b.prop("id","list_table");b.prop("class","list_table");if(getSwitchList().length==0){b.append(addNoSwitchWarningRow())}else{b.append(addPresetSwitchTitleRow());b.append(addNewPresetEntryRow());$("#add_preset_button").click(addPresetHeaderSwitch);var c=getPresetSwitchList();for(var a=0;a<c.length;a++){b.append(addPresetHeaderSwitchRow(c[a],a));document.getElementById("delete_switch_"+a).addEventListener("click",(function(d){return function(){console.log(d);deletePresetSwitch(d);restoreOptions()}})(a))}}}function refreshCustomSwitchView(){table=$("#custom_switch_table #list_table");if(table){table.replaceWith(document.createElement("table"))}table=$("#custom_switch_table #tablecontainer table");table.prop("id","list_table");table.prop("class","list_table");table.append(addHeaderSwitchTitleRow());table.append(addNewHeaderSwitchEntryRow());$("#add_button").click(addHeaderSwitch);$("#add_header").autocomplete({source:availableHeaders});list=getSwitchList();for(var a=0;a<list.length;a++){table.append(addHeaderSwitchRow(list[a],a));document.getElementById("delete_header_"+a).addEventListener("click",(function(b){return function(){console.log(b);deleteHeaderSwitch(b)}})(a))}$("#warning").addClass("invisible");$("#add_header").change(warnOnDisallowedHeader);$("#add_header").bind("autocompletechange",function(b,c){warnOnDisallowedHeader()})}function refreshStatsView(){table=$("#stats_table #tablecontainer table");table.empty();var a=getHeaderUsage();table.append(createTableFromMap(a.header_switches,"Header Switch","Usage"));table.append(createTableFromMap(a.domains,"Domain","Usage"));table.append(createTableFromMap(a.request_types,"Request Type","Usage"))}function createTableFromMap(b,l,f){var m=document.createElement("table");m.setAttribute("class","list_table");var a=document.createElement("tr");var c=document.createElement("td");c.appendChild(document.createTextNode(l));var h=document.createElement("td");h.appendChild(document.createTextNode(f));a.appendChild(c);a.appendChild(h);a.setAttribute("class","title");m.appendChild(a);var j=getSortedMap(b,false);for(var g=0;g<j.length;g++){var e=document.createElement("td");e.appendChild(document.createTextNode(j[g][0]));var d=document.createElement("td");d.appendChild(document.createTextNode(j[g][1]));var k=document.createElement("tr");k.appendChild(e);k.appendChild(d);m.appendChild(k)}return m}function restoreOptions(){refreshPresetSwitchView();refreshCustomSwitchView();refreshStatsView()}function menuItemChange(b,a){$(".menu_controlled").addClass("invisible");b.removeClass("invisible");$(".menuitem").removeClass("selected");a.addClass("selected");setStatus("")}$(window).load(function(){restoreOptions();$(".custom_switch").click(function(){menuItemChange($("#custom_switch_table"),$(this))});$(".preset_switch").click(function(){menuItemChange($("#preset_switch_table"),$(this))});$(".stats").click(function(){menuItemChange($("#stats_table"),$(this))});$(".about").click(function(){menuItemChange($("#about_table"),$(this))});menuItemChange($(".menu_controlled:first"),$(".menuitem:first"))});